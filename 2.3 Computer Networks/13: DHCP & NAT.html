<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 7.9.1 (457703)"/><meta name="altitude" content="98.6658935546875"/><meta name="author" content="Olaf Kotur"/><meta name="created" content="2019-04-06 10:01:46 +0000"/><meta name="latitude" content="52.63970947265625"/><meta name="longitude" content="-1.192719918959887"/><meta name="source" content="desktop.mac"/><meta name="updated" content="2019-04-06 10:39:53 +0000"/><title>13: DHCP &amp; NAT</title></head><body><div><b>Communicating with IP - necessary things</b></div><ol><li><div>IP address</div></li><li><div>Subnet mask</div></li><li><div>Gateway router</div></li><li><div>DNS server</div></li></ol><div><br/></div><div><br/></div><div><b>Dynamic Host Configuration Protocol (DHCP)</b></div><ul><li><div>Allow host to dynamically obtain its IP address from network server when it joins network.</div></li><li><div>Can renew its lease on address in use.</div></li><li><div>Allows reuse of addresses as you only hold address while connected.</div></li><li><div>Plug and play behaviour.</div></li></ul><div><br/></div><div><b>DHCP Background</b></div><ul><li><div>Allows computer to join an IP network without having pre-configured IP address.</div></li><li><div>Provides framework for passing configuration information to hosts.</div></li><li><div>Allows installation and configuration of end systems - incl. manual and automatic IP address assignment.</div></li><li><div>Used by ISPs to minimise set-up costs.</div></li></ul><div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 93px;"/><col style="width: 513px;"/></colgroup><tbody><tr><td colspan="2" style="width: 606px; padding: 8px; border: 1px solid;"><div style="text-align: center; "><b>DHCP Components</b></div></td></tr><tr><td style="width: 93px; padding: 8px; border: 1px solid;"><div><b>Server</b></div></td><td style="width: 513px; padding: 8px; border: 1px solid;"><ul><li><div>Assigned to specific network</div></li><li><div>Configuration parameters - needs to have available IP addresses, subnet masks, network gateway and name server addresses.</div></li></ul></td></tr><tr><td style="width: 93px; padding: 8px; border: 1px solid;"><b>Databases</b></td><td style="width: 513px; padding: 8px; border: 1px solid;"><ul><li><div>1st DB for manual IP acquisition - bound to hardware.</div></li><li><div>2nd DB for pool of addresses - dynamically assigned on request (FCFS)</div></li></ul></td></tr><tr><td style="width: 93px; padding: 8px; border: 1px solid;"><div><b>Clients</b></div></td><td style="width: 513px; padding: 8px; border: 1px solid;"><ul><li><div>Automatically retrieve DCHP settings</div></li><li><div>Speak to DHCP protocol</div></li></ul></td></tr></tbody></table><div><b>DHCP Procedure</b></div></div><ol><li><div><b>Client broadcasts DHCP DISCOVER packet</b></div></li><ol><li><div>Server answers</div></li></ol><li><div><b>DHCP servers lease addresses to clients</b></div></li><ol><li><div>Client sends request</div></li><li><div>Server allocated address from an address pool</div></li><li><div>Server adds client to lease database with timeout</div></li><li><div>Server replies to client with address and servers</div></li></ol><li><div><b>Client sends subsequent request to renew address lease</b></div></li><ol><li><div>After 1/2 the lease time client can renew the lease</div></li><li><div>Provided not timed-out, server sends same address</div></li></ol></ol><div><b><br/></b></div><div><b><img src="13%3A%20DHCP%20&amp;%20NAT.html.resources/E03B140D-029F-4920-A5E0-FBE58081AA8F.png" height="788" width="948"/></b></div><div><b><br/></b></div><div><b><br/></b></div><div><b>DHCP Leases</b></div><ul><li><div><b>Address Usage: </b>After address expired client must stop using address and acquire new address. If there are more than one DHCP server, client can select the best offer.</div></li><li><div><b>Address Leases: </b>There’s more than one:</div></li><ol><li><div><b>Manual: </b>Network manager explicitly assigns all IP addresses.</div></li><li><div><b>Automatic: </b>DHCP server permanently assigns some addresses and dynamically others.</div></li><li><div><b>Dynamic: </b>DHCP server dynamically assigns IP addresses for specific period of time when permanent address is not required.</div></li></ol></ul><div><br/></div><div><img src="13%3A%20DHCP%20&amp;%20NAT.html.resources/04746DD1-4C58-4EDF-96A9-3272FE14AA13.png" height="685" width="925"/></div><div><br/></div><div><br/></div><div><b>Message types</b></div><div><b><img src="13%3A%20DHCP%20&amp;%20NAT.html.resources/54F88C15-1256-4AA4-BA70-E665F85438C9.png" height="655" width="1179"/></b></div><div><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 365px;"/><col style="width: 399px;"/></colgroup><tbody><tr><td style="width: 365px; padding: 8px; border: 1px solid;"><div style="text-align: center; "><b>DHCP Pros</b></div></td><td style="width: 399px; padding: 8px; border: 1px solid;"><div style="text-align: center; "><b>DHCP Cons</b></div></td></tr><tr><td style="width: 365px; padding: 8px; border: 1px solid;"><ul><li><div>Relieves network admin of manual config.</div></li><li><div>Device can be moved from network to network and automatically obtain valid config params.</div></li><li><div>IP addresses are only allocated when needed thus reducing used IPs.</div></li></ul></td><td style="width: 399px; padding: 8px; border: 1px solid;"><ul><li><div>Need machine to constantly run DHCP to connect at all.</div></li><li><div>Uses UDP thus unreliable and insecure - user not needed to provide credentials to obtain a lease.</div></li><li><div>Able to DDOS by requesting a shit ton of leases.</div></li><li><div>DNS can’t be used for DHCP configured hosts.</div></li></ul></td></tr></tbody></table><div><br/></div></div><div><br/></div><hr/><div><b><br/></b></div><div><b><br/></b></div><div><b>Network address translation (NAT): </b>All datagrams leaving local network have same single source NAT IP address with different source port numbers.</div><div><b><img src="13%3A%20DHCP%20&amp;%20NAT.html.resources/16BCAE74-2920-483B-A1A4-40E8758572E6.png" height="445" width="1301"/></b></div><div><b><br/></b></div><div><b>NAT Basic Idea</b></div><ul><li><div>Local network uses just one IP address as far as the internet is concerned</div></li><li><div>Can change addresses of devices in local network without notifying the outside world.</div></li><li><div>Can change ISP without changing addresses of devices in local network</div></li><li><div>Devices inside local network not addressable, invisible by the outside world - mad security.</div></li></ul><div><br/></div><div><b>NAT Implementation</b></div><ol><li><div>Replace source IP address and port number of every datagram to NAT IP address and new port.</div></li><li><div>Remote clients/servers will respond using NAT IP address and port as destination addr.</div></li><li><div>Remember every NAT translation in a table.</div></li></ol><div><br/></div><div><b>Implications</b></div><ul><li><div>16 bit port number field giving us 60,000 LAN-side connection addresses.</div></li><li><div>Routers should only be able to process up to layer 3.</div></li><li><div>Address shortage should be solved by IPv6.</div></li><li><div>Violates end to end argument as app designers now must take this into account.</div></li></ul><div><b><br/></b></div><div><br/></div></body></html>