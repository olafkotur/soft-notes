<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 7.9.1 (457703)"/><meta name="altitude" content="99.49964904785156"/><meta name="author" content="Olaf Kotur"/><meta name="created" content="2019-04-10 18:32:48 +0000"/><meta name="latitude" content="52.63983154296875"/><meta name="longitude" content="-1.192685000859382"/><meta name="source" content="desktop.mac"/><meta name="updated" content="2019-04-10 18:38:57 +0000"/><title>06: Condition Synchronisation</title></head><body><div style="margin-top: 1em; margin-bottom: 1em; background-color: rgb(204, 204, 204); --inversion-type-background-color: simple;"><b>Semaphore Class</b></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);-en-codeblock:true;"><div>public class Semaphore { </div><div><span>    </span>private int count = 0;</div><div><span>    </span></div><div><span>    </span>public Semaphore(int initVal) {</div><div><span><span>    </span>    </span>count = initVal; </div><div><span>    </span>}</div><div><br/></div><div><span>    </span>public synchronized void P() { </div><div><span>    <span>    </span></span>count--;</div><div><span><span>    </span>    </span>if (count &lt; 0) {</div><div><span>    <span>    </span><span>    </span></span>try { </div><div><span>    <span>    <span>    </span><span>    </span></span></span>wait();</div><div><span>    <span>    <span>    </span></span></span>}</div><div><span><span>    </span>    <span>    </span></span>catch (Exception e) {</div><div><span>    <span>    </span><span>    <span>    </span></span></span>System.out.println(e); </div><div><span>    <span>    <span>    </span></span></span>}</div><div><span>    <span>    </span></span>}</div><div><span>    </span>}</div><div><br/></div><div><span>    </span>public synchronized void V() { </div><div><span>    <span>    </span></span>count++;</div><div><span><span>    </span>    </span>if (count &lt;= 0) { </div><div><span>    <span>  <span>    </span>  </span></span>notifyAll();</div><div><span><span>    </span>    </span>} </div><div><span>    </span>}</div><div>}</div></div><div style="margin-top: 1em; margin-bottom: 1em; background-color: rgb(204, 204, 204); --inversion-type-background-color: simple;"><br/></div><div style="margin-top: 1em; margin-bottom: 1em; background-color: rgb(204, 204, 204); --inversion-type-background-color: simple;"><b>Calling Semaphore in a Function</b></div><div style="margin-top: 1em; margin-bottom: 1em; background-color: rgb(204, 204, 204); --inversion-type-background-color: simple;"><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);-en-codeblock:true;"><div>public void add(Integer n, int user) { </div><div><span>    </span>semaphore.P();</div><div><span>    </span>buf_list.add(n);</div><div><span>    </span>elements++;</div><div><span>    </span>System.out.println("User x adds element y/z); </div><div><span>    </span>semaphore.V();</div><div>}</div></div></div><div style="margin-top: 1em; margin-bottom: 1em; background-color: rgb(204, 204, 204); --inversion-type-background-color: simple;"><b><br/></b></div></body></html>