<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 7.9.1 (457703)"/><meta name="author" content="Olaf Kotur"/><meta name="created" content="2019-01-08 16:46:17 +0000"/><meta name="source" content="desktop.mac"/><meta name="updated" content="2019-01-09 13:17:54 +0000"/><title>17: State Pattern</title></head><body><div><b>Case Study: </b>Automated train service.</div><ul><li><div>Allows passengers to buy tickets at station machines for particular journey.</div></li><li><div>Driverless trains receive info about passenger requests.</div></li><li><div>Trains autonomously bid to transport passenger.</div></li><li><div>Central broker chooses best bid and directs chosen train to transport the passenger.</div></li></ul><div><br/></div><div><b>Solution A:</b></div><div><b><img src="17%3A%20State%20Pattern.html.resources/02CBE6FE-EE45-430D-9CB5-C6F56288BCCC.png" height="356" width="882"/></b></div><div><br/></div><div><b>Solution B:</b></div><div><b><img src="17%3A%20State%20Pattern.html.resources/EAA4F39D-ED93-4847-AF59-C80B0ED7B60A.png" height="498" width="922"/></b></div><div><br/></div><div><br/></div><div><b>State Pattern</b></div><ul><li><div><b>Intent: </b>Allow object alter its behaviour when internal state changes. Object will appear to change its class.</div></li><li><div><b>Motivation: </b>Object expected to behave differently depending on which state its currently in.</div></li><li><div><b>Applicability: </b></div></li><ol><li><div>Object’s behaviour depends on its state, must change its behaviour at runtime depending on that state.</div></li><li><div>Operations have large, multi-part conditional statements that depend on object’s state.</div></li></ol></ul><div><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 125px;"/><col style="width: 691px;"/></colgroup><tbody><tr><td colspan="2" style="width: 816px; padding: 8px; border: 1px solid;"><div style="text-align: center; "><b>Participants</b></div></td></tr><tr><td style="width: 125px; padding: 8px; border: 1px solid;"><div><b>Context</b></div></td><td style="width: 691px; padding: 8px; border: 1px solid;"><div>Maintains instance of Concrete State subclass that defines current state.</div></td></tr><tr><td style="width: 125px; padding: 8px; border: 1px solid;"><div><b>State</b></div></td><td style="width: 691px; padding: 8px; border: 1px solid;"><div>Defines interface for encapsulating behaviour associated with particular state of Context.</div></td></tr><tr><td style="width: 125px; padding: 8px; border: 1px solid;"><div><b>Concrete State</b></div></td><td style="width: 691px; padding: 8px; border: 1px solid;">Each subclass implements behaviour associated with state of Context.<br/></td></tr><tr><td style="width: 125px; padding: 8px; border: 1px solid;"><div><b>Collaborations</b></div></td><td style="width: 691px; padding: 8px; border: 1px solid;"><div>Context delegates state-specific request to ConcreteState object. Context may pass itself as argument to State object handling request, letting State object access Context if necessary. </div></td></tr></tbody></table><div><br/></div></div><div><b>State Pattern Structure</b></div><div><b><img src="17%3A%20State%20Pattern.html.resources/FD83DCA4-548F-4BFF-9825-7518F406826F.png" height="444" width="838"/></b></div><div><b><br/></b></div><div><b><br/></b></div><div><b>Consequences</b></div><ol><li><div><b>Handles hierarchy naturally: </b>Create subclass for each substate and override superstar actions if necessary.</div></li><li><div><b>Who defines state transitions: </b>State can return next state but then ConcreteStates become dependant.</div></li><li><div><b>Singleton pattern to define states.</b></div></li><li><div><b>State class used to implement default versions of events: e.g. </b>“do nothing” for events that do not apply to particular ConcreteState.</div></li></ol><div><br/></div><div><b><br/></b></div><div><b>State Table Pattern</b></div><ul><li><div>State diagram can have many object for large state diagrams - often issue as embedded systems usually come with limited memory.</div></li><li><div>State table pattern based on <i><font face="Courier New">m x n</font> </i>state table where m is the number of states and n transitions. Each cell contains pointer to Transition object, which handles event with <font face="Courier New">handle(); </font><font face="Helvetica Neue">Thus hierarchy dealt with by flattening state diagram, thus di</font>fficult to maintain.</div></li></ul><div><br/></div></body></html>