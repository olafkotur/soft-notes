<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 7.9.1 (457703)"/><meta name="altitude" content="57.20000076293945"/><meta name="author" content="Olaf Kotur"/><meta name="created" content="2019-04-27 10:48:10 +0000"/><meta name="latitude" content="54.00787353515625"/><meta name="longitude" content="-2.784868836559085"/><meta name="source" content="desktop.mac"/><meta name="updated" content="2019-04-27 11:23:15 +0000"/><title>18: Concurrency Locking</title></head><body><div><span style="font-weight: bold;">Concurrency Control Technique: </span>Used to ensure isolation property of concurrently executing transactions</div><div><br/></div><div><br/></div><div><span style="font-weight: bold;">Binary Locks: </span>Can have two states or values either locked or unlocked</div><ul><li><div>X is locked thus other operations canny use the variable if requested</div></li><li><div>X is unlocked thus any operation that request can use the variable</div></li><li><div>Often is too restrictive as this means at most only one transaction can hold a lock</div></li></ul><div><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 218px;"/><col style="width: 218px;"/></colgroup><tbody><tr><td style="width: 218px; padding: 8px; border: 1px solid;"><div style="text-align: center; "><span style="font-weight: bold;">Shared Lock (read)</span></div></td><td style="width: 218px; padding: 8px; border: 1px solid;"><div style="text-align: center; "><span style="font-weight: bold;">Exclusive Lock (write)</span></div></td></tr><tr><td style="width: 218px; padding: 8px; border: 1px solid;"><div>Several transaction can hold shared lock on data X if they all access for reading only</div></td><td style="width: 218px; padding: 8px; border: 1px solid;"><div>If transaction wants to write to data X then it must hold this lock</div></td></tr></tbody></table><div><br/></div></div><div><span style="font-weight: bold;">Lock Conversion: </span>Transaction that already holds lock on item can be allowed to convert to another state</div><ul><li><div>If and only if the transaction is the only one currently holding the lock.</div></li></ul><div><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 80px;"/><col style="width: 557px;"/></colgroup><tbody><tr><td colspan="2" style="text-align: center; width: 637px; padding: 8px; border: 1px solid;"><span style="font-weight: bold;">Granularity</span></td></tr><tr><td style="width: 80px; padding: 8px; border: 1px solid;"><div><span style="font-weight: bold;">Fine</span></div></td><td style="width: 557px; padding: 8px; border: 1px solid;"><div>Large number of active locks to be handled by lock manager</div><ul><li><div>More locks means more overhead as it means the lock tables are bigger</div></li></ul></td></tr><tr><td style="width: 80px; padding: 8px; border: 1px solid;"><div><span style="font-weight: bold;">Coarse</span></div></td><td style="width: 557px; padding: 8px; border: 1px solid;"><div>Lower degree of concurrency permitted</div><ul><li><div><span style="font-weight: bold;">E.g. </span>Disk block, if transaction wants to lock record it must lock entire disk block</div></li></ul></td></tr></tbody></table><div><br/></div></div><div><br/></div><hr/><div><br/></div><div><br/></div><div><span style="font-weight: bold;">Two Phase Locking (2PL): </span>Every transaction is divided into two phases:</div><ol><li><div><span style="font-weight: bold;">Growing: </span>Acquires all the locks needed but can’t release any locks</div></li><li><div><span style="font-weight: bold;">Shrinking: </span>Releases locks but can’t acquire any locks</div></li></ol><ul><li><div>Transaction must acquire a lock before doing anything else, conversion upgrade is allowed only here</div></li><li><div>Once that lock is released it may never acquire any new locks, conversion downgrade is allowed only here</div></li></ul><div><br/></div><div><br/></div><div><span style="font-weight: bold;">Deadlock: </span>Two ore more threads blocked forever waiting for each other.</div><div><img src="18%3A%20Concurrency%20Locking.html.resources/C5BAE2D3-06D6-4855-A3E9-E76B40181627.png" height="306" width="830"/></div><div><br/></div><div><br/></div><div><b>Prevention Strategies</b></div><ul><li><div><b>Timeout: </b>If a process waits for X amount of time then removes the lock on it</div></li><li><div>The length of time to wait may be different for each process</div></li><li><div><b>Breaking Locks: </b>If a vulnerable lock (timed out) is active then another transaction can break that lock to access resource</div></li></ul><div><br/></div></body></html>