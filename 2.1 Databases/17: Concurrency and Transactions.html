<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 7.9.1 (457703)"/><meta name="altitude" content="57.20000076293945"/><meta name="author" content="Olaf Kotur"/><meta name="created" content="2019-04-27 10:24:14 +0000"/><meta name="latitude" content="54.00787353515625"/><meta name="longitude" content="-2.784868830727436"/><meta name="source" content="desktop.mac"/><meta name="updated" content="2019-04-30 07:50:13 +0000"/><title>17: Concurrency and Transactions</title></head><body><div><span style="font-weight: bold;">Multiuser: </span>Several users accessing stored data concurrently <span style="font-weight: bold;">e.g. </span>airline reservation system</div><div><br/></div><div><span style="font-weight: bold;">Transaction: </span>Logical unit of database processing that includes one or more database access operations</div><ul><li><div>May involve insertion, deletion modification or retrieval</div></li><li><div>It is an atomic unit of work <span style="font-weight: bold;">i.e. </span>either completed entirely or not at all</div></li></ul><div><br/></div><div><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 188px;"/><col style="width: 555px;"/></colgroup><tbody><tr><td colspan="2" style="width: 743px; padding: 8px; border: 1px solid;"><div style="text-align: center; "><span style="font-weight: bold;">Transaction Operations</span></div></td></tr><tr><td style="width: 188px; padding: 8px; border: 1px solid;"><div><span style="font-weight: bold;">BEGIN_TRANSACTION</span></div></td><td style="width: 555px; padding: 8px; border: 1px solid;"><div>Marks the beginning of transactions</div></td></tr><tr><td style="width: 188px; padding: 8px; border: 1px solid;"><div><span style="font-weight: bold;">READ or WRITE</span></div></td><td style="width: 555px; padding: 8px; border: 1px solid;">Operations executed on database items as part of transaction</td></tr><tr><td style="width: 188px; padding: 8px; border: 1px solid;"><div><span style="font-weight: bold;">END_TRANSACTION</span></div></td><td style="width: 555px; padding: 8px; border: 1px solid;"><div>Marks end of transaction, check whether completed entirely or not</div></td></tr><tr><td style="width: 188px; padding: 8px; border: 1px solid;"><div><span style="font-weight: bold;">COMMIT_TRANSACTION</span></div></td><td style="width: 555px; padding: 8px; border: 1px solid;"><div>Signals succ essful completion, thus commit changes to database</div></td></tr><tr><td style="width: 188px; padding: 8px; border: 1px solid;"><div><span style="font-weight: bold;">ROLLBACK or ABORT</span></div></td><td style="width: 555px; padding: 8px; border: 1px solid;"><div>Signals unsuccessful transactions so undo all applied changes</div></td></tr></tbody></table><div><br/></div></div><div><span style="font-weight: bold;">Read Item: </span>Reads database item named X into program variable also named X</div><ul><li><div>Find address of disk block that contains X</div></li><li><div>Copy disk block into main memory buffer if not already there</div></li><li><div>Copy X from buffer to program variable X</div></li></ul><div><br/></div><div><span style="font-weight: bold;">Write Item: </span>Writes value of program variable X into database also named X</div><ul><li><div>Find address of disk block that contains X</div></li><li><div>Copy disk block into main memory buffer if not already there</div></li><li><div>Copy X from variable into its correct location in buffer</div></li><li><div>Store updated block from buffer back to disk either immediately or some time later</div></li></ul><div><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 122px;"/><col style="width: 608px;"/></colgroup><tbody><tr><td colspan="2" style="width: 730px; padding: 8px; border: 1px solid;"><div style="text-align: center; "><span style="font-weight: bold;">Concurrency Problems</span></div></td></tr><tr><td style="width: 122px; padding: 8px; border: 1px solid;"><div>Lost Update</div></td><td style="width: 608px; padding: 8px; border: 1px solid;"><div>Two transactions that access same DB have operations interleaved in way that makes value of some item incorrect</div></td></tr><tr><td style="width: 122px; padding: 8px; border: 1px solid;"><div>Temporary Update</div></td><td style="width: 608px; padding: 8px; border: 1px solid;"><div><span style="font-weight: bold;">Dirty Read: </span>Transactions updates a DB items and fails - updated item is accessed by another before it is changed back to original value</div></td></tr><tr><td style="width: 122px; padding: 8px; border: 1px solid;"><div>Incorrect Summary</div></td><td style="width: 608px; padding: 8px; border: 1px solid;">Transaction updates a record whilst another transaction is using it to aggregate.</td></tr></tbody></table><div><br/></div></div><div><span style="font-weight: bold;">Types of Failure</span></div><ol><li><div><span style="font-weight: bold;">System Crash: </span>Hard/Software/Network error occurs during transaction execution <span style="font-weight: bold;">e.g. </span>main memory failure</div></li><li><div><span style="font-weight: bold;">Transaction/System Error: </span>Integer overflow, division by 0, interrupted by user</div></li><li><div><span style="font-weight: bold;">Weird cancelations: </span>Data not found</div></li><li><div><span style="font-weight: bold;">Concurrency control enforcement: </span>Control may decide to abort/reschedule as it interferes with another transaction</div></li><li><div><span style="font-weight: bold;">Disk Failure: </span>Read or write malfunction thus loss of data</div></li><li><div><span style="font-weight: bold;">Catastrophes: </span>Power, fire, theft, sabotage...</div></li></ol><div><br/></div><div><br/></div><div><span style="font-weight: bold;">System Log: </span>Used to recover from failures, keeps track of all transaction operations that affect values of database items</div><ul><li><div>Only affected by disk and catastrophic failures</div></li><li><div>Often is backed up periodically to an archive to make sure it canny be harmed from those either</div></li><li><div>This logs all the transaction operations and their current status thus able to undo / redo any operations.</div></li></ul><div><br/></div><div><img src="17%3A%20Concurrency%20and%20Transactions.html.resources/E9773E3F-CB72-4C32-89D7-DFC36AB473D4.png" height="356" width="710"/><br/></div><div><br/></div><div><br/></div><div><span style="font-weight: bold;">ACID Properties of Transactions</span></div><ol><li><div><span style="font-weight: bold;">Atomicity</span>: Either completed or not at all</div></li><li><div><span style="font-weight: bold;">Consistency Preservation:</span> Execution should take DB from one state to another </div></li><li><div><span style="font-weight: bold;">Isolation: </span>Transaction should not be interfered by any other transactions</div></li><li><div><span style="font-weight: bold;">Durability: </span>Changes applied must persist and not lost due to failure</div></li></ol><div><br/></div><div><br/></div><div><span style="font-weight: bold;">Transaction Schedule: </span>Ordering of the operations of transactions</div><ul><li><div><span style="font-weight: bold;">Interleaving: </span>Goes back and forth between two transactions</div></li><li><div>Thus example below shows a non-serial schedule</div></li></ul><div><img src="17%3A%20Concurrency%20and%20Transactions.html.resources/6DEC961B-A683-4AA2-A643-82C8098D0A61.png" height="273" width="719"/><br/></div><div><br/></div><div><br/></div><div><br/></div></body></html>